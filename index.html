<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistics Clinic</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Connell" />
    <script src="index_files/header-attrs-2.20/header-attrs.js"></script>
    <script src="index_files/xaringanExtra-progressBar-0.0.1/progress-bar.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Statistics Clinic
]
.subtitle[
## Using Imperial’s Clusters
]
.author[
### Andrew Connell
]
.date[
### 29 May, 2023
]

---


<style>.xe__progress-bar__container {
  bottom:0;
  opacity: 1;
  position:absolute;
  right:0;
  left: 0;
}
.xe__progress-bar {
  height: 0.25em;
  background-color: #035AA6;
  width: calc(var(--slide-current) / var(--slide-total) * 100%);
}
.remark-visible .xe__progress-bar {
  animation: xe__progress-bar__wipe 200ms forwards;
  animation-timing-function: cubic-bezier(.86,0,.07,1);
}
@keyframes xe__progress-bar__wipe {
  0% { width: calc(var(--slide-previous) / var(--slide-total) * 100%); }
  100% { width: calc(var(--slide-current) / var(--slide-total) * 100%); }
}</style>

&lt;!-- edit name1 and name2 in the YAML above --&gt;

# Why might you need to use the clusters?

&lt;br /&gt;
&lt;br /&gt;

--

* Using Linux Clusters for better performance in your work.

--

* To accomplish large scale computational tasks, simulations, and statistical modelling.

--

* Need to access collaborative work or group uses it for resource management.

--

* Mostly because your local machine is not up to the task!

---

# What is a Linux Cluster?

&lt;br /&gt;
&lt;br /&gt;
--

* A linux cluster is a group of Linux computers, or nodes, working as one system.

--

* Imperial has many different clusters but not all of them are for you.

--

* Make sure you are trying to access the right cluster. 

--

* [Andy Thomas](http://ic.time-domain.co.uk) is generally the owner and maintainer of the clusters.

---
# Warnings

&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;

--

* Before using the cluster be familiar with high-performance computing techniques.

&lt;br /&gt;
&lt;br /&gt;

--

* Read the documentation for the cluster before emailing people to ask how it works!
---

---
class: center, middle

# Clusters at Imperial

---

# Maths Next Gen Cluster

--

The [Maths Next Gen Cluster](https://sysnews.ma.ic.ac.uk/compute-cluster/) is the most used cluster at Imperial.

--

![Maths Next Gen Cluster](figs/mathsclust.png "Mathematics Clusters"){width=50%}
---

# Statistics Cluster

--

The [Statistics Cluster](https://sysnews.ma.ic.ac.uk/stats/index.html) is also available to you.

--

![Maths Next Gen Cluster](figs/statsclust.png "Statistics Clusters"){width=50%}
---

# Accessing the Cluster

&lt;br/&gt;

--

Regardless of the cluster you use the process is basically the same. Here are the steps:

--

* Email and ask the maintainer of the cluster for access. 

--

* Once given access, ensure you are either on site or connected to the IC VPN.

--

* Then, type a command of the form **ssh your_username@cluster_hostname** into the terminal.

--

* You then are prompted for a password which is normally randomly generated that you then set the first time you login.

--

* **You are now connected**

--

* Always logout when you're finished.

---

# Transferring Files

&lt;br/&gt;

--

SCP stands for Secure Copy Protocol and is a way to securely transfer files. In general:

--

* Local to Remote: **scp local_file username@hostname:remote_directory/**

* Remote to Local: **scp username@hostname:remote_file local_directory/**

--

Always ensure that the correct path of source and destination are being used.

--

Note also:

* Use \* for transferring multiple files.
* Use **-r** option to transfer directories.

---

# Queueing Jobs

&lt;br/&gt;

--

A queueing system exists for task management and to share resources! Common tools for this are Slurm, TORQUE, SGE. The preference at Imperial (I think) is TORQUE. This allows you to 

--

* Submit jobs and leave them in the queue so when resources become available the job automatically starts.

--

* Monitor the status of your jobs.

--

* Delete a job before its completion.

--

There is other stuff it can do as well but these are the commands that are necessary.

---

# Submitting Jobs to the Queue

&lt;br/&gt;

--

So once you have used **scp** to get the file you wish to run onto the cluster, it then needs to be run. Do this by:

--

* Use **qsub** command to submit jobs. For instance, **qsub my_script.sh**

--

The job is then added to the queue and is given an ID. The clusters can be set up to give you status updates (read the full documentation or email me). However, if you are logged on:

--

* Use **qstat** command to check the status of your job.

--

If you have realised you no longer want a file to run, use **qdel** to terminate the task.

---

# Retrieving the Output

&lt;br/&gt;

--
By default, the output file is usually stored in the job submission directory. You can use **cat** or **less** to view your output. Further to this:

* **cat job_name.ojob_id** is to view output itself.

* **cat job_name.ejob_id** is to view the error logs.
 
--

Once you are happy with the output, then **scp** the file back to your local machine.

---

# Final Tips and Good Practices

&lt;br/&gt;
--

* Always log out!

&lt;br/&gt;

--

* Regularly clean old files and delete what you don't need!

&lt;br/&gt;

--

* Don't overload the system, respect shared resources.

&lt;br/&gt;

--

* Keep your credentials secure, don't share sensitive information.

&lt;br/&gt;

--

* Ask for help when needed but, consider asking one another before going straight to Andy Thomas. 

---
class: center, middle

# Questions

Please ask questions or submit them at [menti.com](https://www.menti.com/al83uv4zs6br) using code **5606 7649**
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%/%total%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
